import React from 'react';
import PropTypes from 'prop-types';
import useFeatureFlag from './useFeatureFlag';
import { useAccountStats, useNotification } from '../Helpers/Hooks';
import { AccountStatContext } from './VulnerabilityRoutes';

export const AccountStatContextWrapper = ({ children, setLoading, isFederated = false }) => {
    const isEdgeParityEnabled = useFeatureFlag('vulnerability.edge_parity');
    const [addNotification] = useNotification();

    const {
        hasConventionalSystems,
        hasEdgeDevices,
        includesCvesWithoutErrata,
        isAdvisoryAvailable
    } = useAccountStats(isEdgeParityEnabled, setLoading, addNotification);

    return (
        <AccountStatContext.Provider value={{
            hasConventionalSystems,
            hasEdgeDevices,
            includesCvesWithoutErrata,
            isAdvisoryAvailable,
            isFederated
        }}>
            { children }
        </AccountStatContext.Provider>
    );
};

AccountStatContextWrapper.propTypes = {
    children: PropTypes.func,
    setLoading: PropTypes.func,
    isFederated: PropTypes.bool
};
